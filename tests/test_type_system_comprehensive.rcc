// Comprehensive test for the new type system features

// ============================================================
// 1. TUPLE TYPES
// ============================================================
type Coordinate = [int, int];
type RGB = [int, int, int];
type Person = [str, int]; // name, age

let coord: Coordinate;
let color: RGB;
let alice: Person;

// ============================================================
// 2. OBJECT INLINE TYPES WITH OPTIONAL AND READONLY
// ============================================================
type User = {
    readonly id: int,
    name: str,
    email?: str,
    age?: int
};

let user1: User = {
    id: 1,
    name: "Alice"
};

let user2: User = {
    id: 2,
    name: "Bob",
    email: "bob@example.com",
    age: 30
};

// ============================================================
// 3. UNION TYPES
// ============================================================
type StringOrNumber = str | int;
type Status = str | int | bool;
type MaybeString = str | null;

let value1: StringOrNumber = "hello";
let value2: StringOrNumber = 42;
let status: Status = true;
let maybeText: MaybeString = null;

// ============================================================
// 4. INTERSECTION TYPES
// ============================================================
type HasName = { name: str };
type HasAge = { age: int };
type PersonInfo = HasName & HasAge;

// ============================================================
// 5. NEVER TYPE
// ============================================================
type NeverOrString = never | str;
let result: NeverOrString = "success";

// ============================================================
// 6. READONLY TYPE
// ============================================================
type ReadonlyString = readonly str;
type ReadonlyConfig = readonly { host: str, port: int };

let immutableText: ReadonlyString = "cannot change";

// ============================================================
// 7. COMPLEX NESTED TYPES
// ============================================================
type ApiResponse = {
    readonly status: int,
    data: {
        users: [str, int, bool],
        metadata: { total: int, page: int }
    },
    error?: str
};

type Config = {
    readonly apiUrl: str,
    timeout?: int,
    retries?: int,
    headers: { authorization?: str }
};

let config: Config = {
    apiUrl: "https://api.example.com",
    headers: {}
};

// ============================================================
// 8. ARRAYS OF COMPLEX TYPES
// ============================================================
type UserArray = User[];
type CoordinateArray = Coordinate[];

let users: UserArray = [];
let coordinates: CoordinateArray = [];

// ============================================================
// 9. NULLABLE COMPLEX TYPES
// ============================================================
type NullableUser = User?;
type NullableCoordinate = Coordinate?;

let optionalUser: NullableUser = null;

// ============================================================
// 10. COMBINATION OF FEATURES
// ============================================================
type ComplexType = {
    readonly id: int,
    data: StringOrNumber[],
    config?: Config,
    position: Coordinate,
    users: User[]
};

// ============================================================
// 11. FUNCTIONS WITH ADVANCED TYPES
// ============================================================
fn processString(value: StringOrNumber): void {
    print(value);
}

fn getUser(id: int): User {
    let u: User = {
        id: id,
        name: "Test User"
    };
    return u;
}

fn processOptional(value: MaybeString): void {
    print(value);
}

// ============================================================
// 12. TESTING THE FUNCTIONS
// ============================================================
processString("hello");
processString(42);

let testUser: User = getUser(100);
print(testUser.name);

processOptional("text");
processOptional(null);

// ============================================================
// 13. NESTED OBJECT TYPES
// ============================================================
type NestedType = {
    level1: {
        level2: {
            level3: str
        }
    }
};

// ============================================================
// FINAL OUTPUT
// ============================================================
print("All advanced type system tests completed successfully!");
